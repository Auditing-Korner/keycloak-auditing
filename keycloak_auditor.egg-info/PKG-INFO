Metadata-Version: 2.4
Name: keycloak-auditor
Version: 0.1.0
Summary: Modular Keycloak security auditing framework with Nuclei integration
Author: RFS Team
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: requests>=2.32.3
Requires-Dist: click>=8.1.7
Requires-Dist: rich>=13.7.1
Requires-Dist: pydantic>=2.8.2
Requires-Dist: jinja2>=3.1.4
Dynamic: license-file

# keycloak-auditing

A modular Python framework to audit the security of Keycloak. It integrates Nuclei workflows/templates with automated enumeration, audit checks, vulnerability scanning, safe exploitation, and final report generation.

[![Status](https://img.shields.io/badge/status-active-brightgreen.svg)](docs/index.md) [![Python](https://img.shields.io/badge/python-3.10%2B-blue.svg)](https://www.python.org/) [![License](https://img.shields.io/badge/license-MIT-informational.svg)](LICENSE)

- Docs: [Site](docs/index.md) · [Tutorial](docs/tutorial.md) · [CLI Reference](docs/reference.md)

---

## Table of Contents
- [Overview](#overview)
- [Key Features](#key-features)
- [Architecture](#architecture)
- [Installation](#installation)
- [Quickstart](#quickstart)
- [Usage](#usage)
- [Configuration & Performance](#configuration--performance)
- [Wordlists](#wordlists)
- [Outputs](#outputs)
- [Roadmap](#roadmap)
- [Contributing](#contributing)
- [Security & Responsible Use](#security--responsible-use)
- [License](#license)

## Overview
Keycloak Auditor helps security professionals assess Keycloak deployments. It combines public discovery with authenticated checks (when provided), leverages local Nuclei templates/workflows for vulnerability detection, safely demonstrates select issues, and produces actionable reports.

## Key Features
- Enumeration: OIDC discovery, realms, clients/roles/groups/IDPs/flows counts (with token)
- Configuration Audit: HTTPS, security headers, admin console exposure, and more
- Vulnerability Scanning: Runs local Nuclei templates/workflows against targets
- Safe Exploitation: Non-destructive PoCs to validate suspicious findings
- Reporting: Consolidated Markdown and JSON reports with severity breakdowns

## Architecture
- CLI (`keycloak_auditor/cli.py`) orchestrates stages: enumerate → audit → scan → exploit → report
- Core config and throttled HTTP client for rate-limited, reliable requests
- Nuclei integration executes templates/workflows and parses JSONL output
- Wordlists compose target URLs (paths + subdomains) for broader coverage

```
+---------+     +------------+     +--------+     +-----------+     +---------+
| Config  | --> | Enumerate  | --> | Audit  | --> | Scan (NU) | --> | Report  |
+---------+     +------------+     +--------+     +-----------+     +---------+
                       \______________ Exploit (safe) _____________/
```

## Installation

- Python 3.10+
- Optional: Nuclei binary on PATH (`nuclei`) or specify via `--nuclei-path`

```bash
pip install -e .
```

## Quickstart
Basic help:
```bash
keycloak-auditor --help
```

Run core workflow (adjust URL/realm):
```bash
keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master \
  --out audit-output enumerate

keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master audit

keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master \
  --nuclei-templates nuclei-templates scan --workflow

keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master exploit

keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master report
```

Authenticated enumeration (client credentials):
```bash
keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master \
  --client-id admin-cli \
  --client-secret $SECRET \
  enumerate
```

## Usage
Performance and safety flags:
- `--rate-limit`: HTTP/Nuclei requests per second (default 5)
- `--timeout`: HTTP/Nuclei timeout seconds (default 15)
- `--retries`: HTTP retries (default 2)
- `--insecure`: skip TLS verification

See [CLI Reference](docs/reference.md) for all options.

## Configuration & Performance
- Requests are rate-limited (global RPS) with retries and backoff.
- `--rate-limit` is applied to both HTTP requests and Nuclei via `-rate-limit`.
- Use higher values cautiously to avoid throttling or noisy scans.

## Wordlists
Wordlists live in `wordlists/` and drive broader discovery:
- `keycloak-directories.txt`: common paths (supports `{realm}`)
- `keycloak-subdomains.txt`: common subdomain prefixes
- `keycloak-admin-api.txt`: admin API endpoints (supports `{realm}`)

Enable during scans:
```bash
keycloak-auditor \
  --base-url https://kc.example.com \
  --realm master \
  --use-wordlists \
  --wordlists-dir wordlists \
  --nuclei-templates nuclei-templates \
  scan --workflow
```
The scanner composes target URLs into `audit-output/targets.txt` and uses `-l` for Nuclei.

## Outputs
- `audit-output/enumeration.json`
- `audit-output/audit.json`
- `audit-output/nuclei.json`, `audit-output/nuclei.jsonl`, `audit-output/targets.txt`
- `audit-output/exploitation.json`
- `audit-output/report.md`, `audit-output/report.json`

## Roadmap
- Deeper configuration checks (password/MFA/brute-force policies, cookies/CSP/HSTS)
- Authenticated Nuclei runs with token/header injection
- OIDC/SAML flow validations (PKCE, redirect URI strictness, token lifetime)
- HTML/PDF reports, SARIF/CSV export, CVE mapping by Keycloak version
- CI integration and baseline/suppressions

## Contributing
Contributions are welcome! Please:
- Open an issue to discuss major changes
- Submit PRs with clear descriptions and tests when possible
- Follow the project’s coding style and keep code readable

Run tests:
```bash
pytest -q
```

## Security & Responsible Use
Use this framework only against systems you are authorized to test. Some checks require admin/token; without it, enumeration is limited to public endpoints.

## License
This project is licensed under the MIT License. See [LICENSE](LICENSE).
